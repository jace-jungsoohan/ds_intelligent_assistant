
# DS Intelligent Assistant - ê°œë°œ í˜„í™© ìš”ì•½

## ğŸ“… ì‘ì„±ì¼: 2026-01-08

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

**ëª©í‘œ**: Willog ë¬¼ë¥˜ ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ RAG(Retrieval-Augmented Generation) ì‹œìŠ¤í…œ êµ¬ì¶•

**í•µì‹¬ ê°œë…**:
- **PDF ë¬¸ì„œ**: RAG ì„œë¹„ìŠ¤ ê¸°íš ë° ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ì°¸ê³ ìš© (ë°ì´í„° ì†ŒìŠ¤ ì•„ë‹˜)
- **BigQuery**: ì‹¤ì œ ë°ì´í„° ì†ŒìŠ¤ (ëª¨ë“  ë°ì´í„° ì¡°íšŒëŠ” BigQueryë¥¼ í†µí•´)

**ê¸°ìˆ  ìŠ¤íƒ**:
- **LLM**: Google Vertex AI (gemini-2.5-flash)
- **í”„ë ˆì„ì›Œí¬**: LangChain
- **ë°ì´í„°**: BigQuery (`willog-prod-data-gold.rag`)
- **ì–¸ì–´**: Python 3.9+

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤                          â”‚
â”‚              (Next.js Frontend + Recharts)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ API Request
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FastAPI Backend                        â”‚
â”‚                  (app/api/main.py)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Orchestrator                            â”‚
â”‚              (app/agents/orchestrator.py)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Router                               â”‚
â”‚                  (app/agents/router.py)                      â”‚
â”‚          ì§ˆë¬¸ ìœ í˜• ë¶„ë¥˜ â†’ SQL_AGENT / RETRIEVAL_AGENT         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        SQL Agent          â”‚   â”‚     (í™•ì¥ ì˜ˆì •)            â”‚
â”‚ (app/agents/sql_agent.py) â”‚   â”‚  ì¶”ê°€ ì—ì´ì „íŠ¸ ì˜ì—­         â”‚
â”‚                           â”‚   â”‚                           â”‚
â”‚ â€¢ ìì—°ì–´ â†’ SQL ë³€í™˜         â”‚   â”‚  General Agent (ëŒ€í™”)     â”‚
â”‚ â€¢ BigQuery ìŠ¤í‚¤ë§ˆ í™œìš©      â”‚   â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ SQL Queries
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     BigQuery Client       â”‚
â”‚  (google-cloud-bigquery)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“š ì£¼ìš” ì •ë³´ ë° ì»¨í…ìŠ¤íŠ¸

*   **ë°ì´í„° ì†ŒìŠ¤ (Live)**:
    *   ëª¨ë“  ë°ì´í„°ëŠ” **BigQuery `rag` ë°ì´í„°ì…‹ì˜ ì›ì²œ í…Œì´ë¸”**(`corning_transport`, `corning_merged`)ë¡œë¶€í„° ì‹¤ì‹œê°„ìœ¼ë¡œ ì§‘ê³„ë©ë‹ˆë‹¤.
    *   `rag` ë°ì´í„°ì…‹ì˜ ë§ˆíŠ¸(Mart)ë“¤ì€ ì‹¤ì œ ì›ì²œ í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ë„ë¡ êµ¬ì„±ë˜ì–´ ìˆì–´ ë°ì´í„° ì •í•©ì„±ì´ ë³´ì¥ë©ë‹ˆë‹¤.

*   **êµ¬í˜„ëœ ê¸°ëŠ¥**:
    *   **SQL Agent**: `gemini-2.5-flash` ê¸°ë°˜ Text-to-SQL ë° `pandas` DataFrame ë³€í™˜.
    *   **Response Synthesis**: SQL ê²°ê³¼(JSON)ë¥¼ Frontendë¡œ ì „ë‹¬í•˜ì—¬ ìë™ ì‹œê°í™”.
    *   **Next.js UI**: ì±„íŒ… ì¸í„°í˜ì´ìŠ¤, ë°ì´í„° í…Œì´ë¸”, Recharts ì‹œê°í™”, ì¶”ì²œ ì§ˆì˜(Chips) êµ¬í˜„.
    *   **Cloud Deployment**: Google Cloud Run (Multi-stage Build) ë°°í¬ ì™„ë£Œ.

*   **ìš´ì˜ ì •ë³´**:
    *   **ì„œë¹„ìŠ¤ URL**: [https://willog-assistant-753372497836.asia-northeast3.run.app](https://willog-assistant-753372497836.asia-northeast3.run.app)
    *   **ë¦¬ì „**: `asia-northeast3` (Seoul)

---

## 3. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ds_intelligent_assistant/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ orchestrator.py      # ì „ì²´ í”Œë¡œìš° ì œì–´
â”‚   â”‚   â”œâ”€â”€ router.py            # ì§ˆë¬¸ ë¶„ë¥˜ (SQL/Retrieval)
â”‚   â”‚   â”œâ”€â”€ sql_agent.py         # SQL ìƒì„± ì—ì´ì „íŠ¸
â”‚   â”‚   â””â”€â”€ retrieval_agent.py   # ë¬¸ì„œ ê²€ìƒ‰ ì—ì´ì „íŠ¸ (Stub)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ config.py            # ì„¤ì • ê´€ë¦¬ (Pydantic)
â”‚   â””â”€â”€ ui/
â”‚       â””â”€â”€ __init__.py
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ bq_wrapper/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ client.py            # BigQuery í´ë¼ì´ì–¸íŠ¸ ë˜í¼
â”‚   â”‚   â””â”€â”€ schema.py            # í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ì •ì˜
â”‚   â””â”€â”€ vectordb/
â”‚       â””â”€â”€ __init__.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_agent.py            # ì—ì´ì „íŠ¸ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ requirements.txt             # ì˜ì¡´ì„± íŒ¨í‚¤ì§€
â”œâ”€â”€ README_SETUP.md              # ìê²©ì¦ëª… ì„¤ì • ê°€ì´ë“œ
â””â”€â”€ willog-prod-data-gold-*.json # GCP ì„œë¹„ìŠ¤ ê³„ì • í‚¤
```

---

## 4. í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìƒì„¸

### 4.1 SQL Agent (`app/agents/sql_agent.py`)
- **ê¸°ëŠ¥**: ìì—°ì–´ ì§ˆë¬¸ì„ BigQuery SQLë¡œ ë³€í™˜
- **ëª¨ë¸**: `gemini-2.5-flash` (Vertex AI)
- **í”„ë¡¬í”„íŠ¸**: í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ë™ì  ì£¼ì…í•˜ì—¬ ì •í™•í•œ SQL ìƒì„± ìœ ë„

### 4.2 Router (`app/agents/router.py`)
- **ê¸°ëŠ¥**: ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì í•©í•œ ì—ì´ì „íŠ¸ë¡œ ë¼ìš°íŒ…
- **ë¶„ë¥˜ ê¸°ì¤€**:
  - `SQL_AGENT`: ìˆ˜ì¹˜/í†µê³„ ì§ˆë¬¸ (ë¬¼ëŸ‰, ì˜¨ë„, ì¶©ê²©ìœ¨ ë“±)
  - `RETRIEVAL_AGENT`: ì§€ì‹/ê·œì • ì§ˆë¬¸ (ì •ì±…, ê¸°ì¤€ ì„¤ëª… ë“±)

### 4.3 BigQuery ìŠ¤í‚¤ë§ˆ (`packages/bq_wrapper/schema.py`)
PDF ëª…ì„¸ì„œ ê¸°ë°˜ìœ¼ë¡œ ì •ì˜ëœ ê°€ìƒ í…Œì´ë¸”:

| í…Œì´ë¸”ëª… | ìš©ë„ |
|---------|------|
| `view_transport_stats` | ì¼ìë³„ ìš´ì†¡ ë¬¼ëŸ‰/ê±´ìˆ˜/ì´ìŠˆ ì§‘ê³„ |
| `view_issue_stats` | ì¶©ê²©/ì´íƒˆë¥  í†µê³„ (5G/10G ê¸°ì¤€) |
| `view_sensor_stats` | ì„¼ì„œ ë°ì´í„° (ì˜¨ë„/ìŠµë„) ìš”ì•½ |

### 4.4 ì„¤ì • (`app/core/config.py`)
```python
PROJECT_ID = "willog-prod-data-gold"
DATASET_ID = "rag"
LOCATION   = "us-central1"
```

---

## 5. í…ŒìŠ¤íŠ¸ ê²°ê³¼

### âœ… ì„±ê³µ ì¼€ì´ìŠ¤
```
ì§ˆë¬¸: "ì§€ë‚œë‹¬ ë² íŠ¸ë‚¨í–‰ ë¬¼ëŸ‰ ì•Œë ¤ì¤˜"
ë¼ìš°íŒ…: SQL_AGENT
ìƒì„± SQL:
SELECT sum(total_volume)
FROM view_transport_stats
WHERE date BETWEEN DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH), MONTH) 
              AND LAST_DAY(DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH))
  AND destination = 'Vietnam'
```

---

## 6. ì™„ë£Œëœ ì‘ì—…

| ì‘ì—… | ìƒíƒœ |
|-----|------|
| ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ì‘ì„± | âœ… ì™„ë£Œ |
| êµ¬í˜„ ê³„íšì„œ ì‘ì„± (í•œê¸€) | âœ… ì™„ë£Œ |
| í”„ë¡œì íŠ¸ êµ¬ì¡° ì´ˆê¸°í™” | âœ… ì™„ë£Œ |
| BigQuery Wrapper êµ¬í˜„ | âœ… ì™„ë£Œ |
| í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ì •ì˜ | âœ… ì™„ë£Œ |
| SQL Agent êµ¬í˜„ | âœ… ì™„ë£Œ |
| Router êµ¬í˜„ | âœ… ì™„ë£Œ |
| Orchestrator êµ¬í˜„ | âœ… ì™„ë£Œ |
| Retrieval Agent (Stub) | âœ… ì™„ë£Œ |
| GCP ìê²©ì¦ëª… ì—°ê²° | âœ… ì™„ë£Œ |
| End-to-End í…ŒìŠ¤íŠ¸ | âœ… ì™„ë£Œ |
| Backend API (FastAPI) | âœ… ì™„ë£Œ |
| Frontend UI (Next.js) | âœ… ì™„ë£Œ |
| Production Deployment | âœ… ì™„ë£Œ |

---

## 7. í–¥í›„ ê°œë°œ ê³¼ì œ

| ìš°ì„ ìˆœìœ„ | ì‘ì—… | ì„¤ëª… |
|---------|-----|------|
| ğŸ”´ ë†’ìŒ | Retrieval Agent ì™„ì„± | PDF ë¬¸ì„œë¥¼ Vector Storeì— ì¸ë±ì‹± í›„ RAG êµ¬í˜„ |
| ğŸŸ¢ ë‚®ìŒ | í”„ë¡¬í”„íŠ¸ ìµœì í™” | ë” ì •í™•í•œ SQL ìƒì„±ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ íŠœë‹ |
| ğŸŸ¢ ë‚®ìŒ | í‰ê°€ ì§€í‘œ êµ¬ì¶• | ì—ì´ì „íŠ¸ ì„±ëŠ¥ ì¸¡ì •ì„ ìœ„í•œ í…ŒìŠ¤íŠ¸ ì…‹ êµ¬ì„± |

---

## 8. ì‹¤í–‰ ë°©ë²•

```bash
# 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export GOOGLE_APPLICATION_CREDENTIALS="/path/to/willog-prod-data-gold-*.json"

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# 3. ì—ì´ì „íŠ¸ ì‹¤í–‰
python3 app/agents/orchestrator.py "ì§€ë‚œë‹¬ ë² íŠ¸ë‚¨í–‰ ë¬¼ëŸ‰ ì•Œë ¤ì¤˜"
```

---

## 9. ì°¸ê³  ë¬¸ì„œ

- `DST-RAG êµ¬ì„± ì •ë¦¬-080126-023847.pdf`: ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì„œ
- `.gemini/antigravity/brain/.../implementation_plan.md`: ìƒì„¸ êµ¬í˜„ ê³„íšì„œ
- `.gemini/antigravity/brain/.../architecture.md`: ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

