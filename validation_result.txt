An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
An error occurred: module 'importlib.metadata' has no attribute 'packages_distributions'
ğŸ” Validating Suggested Questions...

[1/10] Testing: ğŸ“‰ ìƒí•˜ì´(CNSHG)í–‰ ì´ ë¬¼ëŸ‰ ë° íŒŒì†ìœ¨
DEBUG: Generated SQL for 'ğŸ“‰ ìƒí•˜ì´(CNSHG)í–‰ ì´ ë¬¼ëŸ‰ ë° íŒŒì†ìœ¨': [```sql
SELECT
    t1.destination,
    COUNT(t1.code) AS total_shipments,
    COUNTIF(t1.is_damaged) AS damaged_shipments,
    SAFE_DIVIDE(COUNTIF(t1.is_damaged), COUNT(t1.code)) AS damage_rate
FROM
    `willog-prod-data-gold.rag.mart_logistics_master` AS t1
WHERE
    t1.destination = 'CNSHG'
GROUP BY
    t1.destination
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (1, 4)
  âœ… Success (1 rows)
------------------------------
[2/10] Testing: ğŸ”¥ êµ¬ê°„ë³„ ì¶©ê²© ë¦¬ìŠ¤í¬ íˆíŠ¸ë§µ ë¶„ì„
DEBUG: Generated SQL for 'ğŸ”¥ êµ¬ê°„ë³„ ì¶©ê²© ë¦¬ìŠ¤í¬ íˆíŠ¸ë§µ ë¶„ì„': [```sql
SELECT
    lat_center,
    lon_center,
    location_label,
    risk_score,
    high_impact_events
FROM
    `willog-prod-data-gold.rag.mart_risk_heatmap`
ORDER BY
    risk_score DESC
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (964, 5)
  âœ… Success (964 rows)
------------------------------
[3/10] Testing: âš ï¸ ëˆ„ì  ì¶©ê²© í”¼ë¡œë„ Top 5 ìš´ì†¡ ê±´
DEBUG: Generated SQL for 'âš ï¸ ëˆ„ì  ì¶©ê²© í”¼ë¡œë„ Top 5 ìš´ì†¡ ê±´': [```sql
SELECT
    code,
    cumulative_shock_index
FROM
    `willog-prod-data-gold.rag.mart_logistics_master`
ORDER BY
    cumulative_shock_index DESC
LIMIT 5
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (5, 2)
  âœ… Success (5 rows)
------------------------------
[4/10] Testing: ğŸŒ¡ï¸ ì˜¤ì‚¬ì¹´í–‰ ì˜¨ë„ ì´íƒˆ í‰ê·  ì§€ì† ì‹œê°„
DEBUG: Generated SQL for 'ğŸŒ¡ï¸ ì˜¤ì‚¬ì¹´í–‰ ì˜¨ë„ ì´íƒˆ í‰ê·  ì§€ì† ì‹œê°„': [```sql
SELECT
    AVG(temp_excursion_duration_min) AS avg_temp_excursion_duration_min
FROM
    `willog-prod-data-gold.rag.mart_logistics_master`
WHERE
    destination = 'JPOSA'
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (1, 1)
  âœ… Success (1 rows)
------------------------------
[5/10] Testing: ğŸ“Š í¬ì¥ íƒ€ì…ë³„ íŒŒì†ìœ¨ ë° ì•ˆì „ ì ìˆ˜ ë¹„êµ
DEBUG: Generated SQL for 'ğŸ“Š í¬ì¥ íƒ€ì…ë³„ íŒŒì†ìœ¨ ë° ì•ˆì „ ì ìˆ˜ ë¹„êµ': [```sql
SELECT
    package_type,
    damage_rate,
    safety_score
FROM
    `willog-prod-data-gold.rag.mart_quality_matrix`
ORDER BY
    package_type
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (48, 3)
  âœ… Success (48 rows)
------------------------------
[6/10] Testing: ğŸ›³ï¸ í•´ìƒ ìš´ì†¡ ì¤‘ 5G ì´ìƒ ì¶©ê²© ë°œìƒ ë¹„ìœ¨
DEBUG: Generated SQL for 'ğŸ›³ï¸ í•´ìƒ ìš´ì†¡ ì¤‘ 5G ì´ìƒ ì¶©ê²© ë°œìƒ ë¹„ìœ¨': [```sql
SELECT
    t2.transport_mode,
    COUNTIF(t1.shock_g >= 5) as high_shock_count,
    COUNT(*) as total_sensor_readings,
    SAFE_DIVIDE(COUNTIF(t1.shock_g >= 5), COUNT(*)) as high_shock_ratio
FROM `willog-prod-data-gold.rag.mart_sensor_detail` AS t1
JOIN `willog-prod-data-gold.rag.mart_logistics_master` AS t2
  ON t1.code = t2.code
WHERE
    t2.transport_mode = 'Ocean'
GROUP BY
    t2.transport_mode
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (0, 4)
  âš ï¸ Empty Result (0 rows) - Data might effectively not exist
------------------------------
[7/10] Testing: ğŸ“ ë² íŠ¸ë‚¨ ê²½ë¡œ ìŠµë„ ì·¨ì•½ êµ¬ê°„ ë¶„ì„
DEBUG: Generated SQL for 'ğŸ“ ë² íŠ¸ë‚¨ ê²½ë¡œ ìŠµë„ ì·¨ì•½ êµ¬ê°„ ë¶„ì„': [```sql
SELECT
    t1.lat,
    t1.lon,
    COUNT(t1.humidity) AS humidity_readings_count,
    AVG(t1.humidity) AS average_humidity
FROM
    `willog-prod-data-gold.rag.mart_sensor_detail` AS t1
JOIN
    `willog-prod-data-gold.rag.mart_logistics_master` AS t2
ON
    t1.code = t2.code
WHERE
    t2.destination LIKE 'VN%' OR t2.destination IN ('VNSGN', 'VNHPH')
GROUP BY
    t1.lat,
    t1.lon
ORDER BY
    humidity_readings_count DESC
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (0, 4)
  âš ï¸ Empty Result (0 rows) - Data might effectively not exist
------------------------------
[8/10] Testing: â„ï¸ ì˜í•˜ ì˜¨ë„ì—ì„œ ë°œìƒí•œ ì¶©ê²© ê±´ìˆ˜
DEBUG: Generated SQL for 'â„ï¸ ì˜í•˜ ì˜¨ë„ì—ì„œ ë°œìƒí•œ ì¶©ê²© ê±´ìˆ˜': [```sql
SELECT
    COUNT(*) as shock_count_below_zero
FROM `willog-prod-data-gold.rag.mart_sensor_detail`
WHERE
    temperature < 0
    AND shock_g > 0
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (1, 1)
  âœ… Success (1 rows)
------------------------------
[9/10] Testing: ğŸ† ìš´ì†¡ì‚¬ë³„ ë°°ì†¡ í’ˆì§ˆ ë²¤ì¹˜ë§ˆí‚¹
DEBUG: Generated SQL for 'ğŸ† ìš´ì†¡ì‚¬ë³„ ë°°ì†¡ í’ˆì§ˆ ë²¤ì¹˜ë§ˆí‚¹': [```sql
SELECT
    transport_mode,
    AVG(damage_rate) AS average_damage_rate,
    AVG(avg_fatigue_score) AS average_fatigue_score,
    AVG(safety_score) AS average_safety_score
FROM `willog-prod-data-gold.rag.mart_quality_matrix`
GROUP BY transport_mode
ORDER BY transport_mode
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (7, 4)
  âœ… Success (7 rows)
------------------------------
[10/10] Testing: ğŸš¨ ìµœê·¼ 1ì£¼ì¼ High Risk ë“±ê¸‰ ìš´ì†¡ ê±´
DEBUG: Generated SQL for 'ğŸš¨ ìµœê·¼ 1ì£¼ì¼ High Risk ë“±ê¸‰ ìš´ì†¡ ê±´': [```sql
SELECT
    COUNT(DISTINCT code) AS high_risk_shipment_count
FROM
    `willog-prod-data-gold.rag.mart_logistics_master`
WHERE
    risk_level = 'High'
    AND departure_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
```]
DEBUG: Executing query on BigQuery...
DEBUG: Query executed. Result shape: (1, 1)
  âœ… Success (1 rows)
------------------------------

ğŸ“‹ Summary:
Total: 10
Passed: 8
Failed: 2

âŒ Failed Questions:
- ğŸ›³ï¸ í•´ìƒ ìš´ì†¡ ì¤‘ 5G ì´ìƒ ì¶©ê²© ë°œìƒ ë¹„ìœ¨
- ğŸ“ ë² íŠ¸ë‚¨ ê²½ë¡œ ìŠµë„ ì·¨ì•½ êµ¬ê°„ ë¶„ì„
